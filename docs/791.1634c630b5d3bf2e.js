"use strict";(self.webpackChunkmarmoraria_sao_carlos=self.webpackChunkmarmoraria_sao_carlos||[]).push([[791],{5791:(ee,T,o)=>{o.r(T),o.d(T,{CidadeModule:()=>K});var p=o(6814),n=o(6223),E=o(8645),c=o(9773),l=function(a){return a.CREATE_CITY_EVENT="Criar cidade",a.EDIT_CITY_EVENT="Editar cidade",a.VIEW_CITY_EVENT="Visualizar cidade",a}(l||{}),e=o(4946),u=o(5219),g=o(1365),b=o(2098),F=o(3004),m=o(5118),D=o(5619),I=o(8180);let y=(()=>{class a{constructor(){this.cidadesDataEmitter$=new D.X(null),this.cidadesDatas=[]}setCidadesDatas(t){t&&this.cidadesDataEmitter$.next(t)}getCidadesDataEmitter(){return this.cidadesDataEmitter$.asObservable()}getCidadesDatas(){return this.cidadesDataEmitter$.pipe((0,I.q)(1)).subscribe({next:t=>{t&&(this.cidadesDatas=t)}}),this.cidadesDatas}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var x=o(3714),A=o(3866);function w(a,C){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.handleSubmitAddCidade())}),e.TgZ(2,"div",2),e._UZ(3,"input",3),e.TgZ(4,"div",4)(5,"p-dropdown",5),e.NdJ("onChange",function(d){e.CHM(t);const s=e.oxw();return e.KtG(s.onEstadoChange(d.value))}),e.qZA()(),e.TgZ(6,"div",6)(7,"button",7),e._uU(8,"Concluir"),e.qZA()()()()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.addCidadeForm),e.xp6(4),e.Q6J("options",t.estados)}}function N(a,C){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.handleSubmitEditCidade())}),e.TgZ(2,"div",2),e._UZ(3,"input",3),e.TgZ(4,"div",4)(5,"p-dropdown",5),e.NdJ("onChange",function(d){e.CHM(t);const s=e.oxw();return e.KtG(s.onEstadoChange(d.value))}),e.qZA()(),e.TgZ(6,"div",6)(7,"button",7),e._uU(8,"Concluir"),e.qZA()()()()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.editCidadeForm),e.xp6(4),e.Q6J("options",t.estados)}}let Y=(()=>{class a{constructor(t,i,d,s,r,v,X,W){this.formBuilder=t,this.messageService=i,this.router=d,this.cidadeService=s,this.estadoService=r,this.ref=v,this.cidadeDTO=X,this.datePipe=W,this.destroy$=new E.x,this.cidadeDatas=[],this.estados=[],this.addCidadeForm=this.formBuilder.group({nome:["",n.kI.required],estado:this.formBuilder.group({id:[null,n.kI.required],nome:["",n.kI.required],sigla:["",n.kI.required],cidades:[[]],dataCriacao:[this.getDate()],dataAtualizacao:[""]}),dataCriacao:[this.getDate()],dataAtualizacao:[""]}),this.editCidadeForm=this.formBuilder.group({nome:["",n.kI.required],estado:this.formBuilder.group({id:[null,n.kI.required],nome:["",n.kI.required],sigla:["",n.kI.required],cidades:[[]],dataCriacao:[this.getDate()],dataAtualizacao:[""]}),dataCriacao:[this.getDate()],dataAtualizacao:[""]}),this.addCidadeAction=l.CREATE_CITY_EVENT,this.editCidadeAction=l.EDIT_CITY_EVENT}ngOnInit(){this.cidadeAction=this.ref.data,this.cidadeAction?.event.action===this.editCidadeAction&&this.cidadeAction?.cidadeList&&(this.getCidadeSelectedDatas(this.cidadeAction.event.id),this.setEstadoNosFormularios(this.estadoSelecionado)),this.getEstados()}getDate(){return this.datePipe.transform(new Date,"dd/MM/yyyy HH:mm")||""}setEstadoNosFormularios(t){const i=this.editCidadeForm,d=this.addCidadeForm;i.get("estado.id")?.setValue(t?.id),i.get("estado.nome")?.setValue(t?.nome),i.get("estado.sigla")?.setValue(t?.sigla),d.get("estado.id")?.setValue(t?.id),d.get("estado.nome")?.setValue(t?.nome),d.get("estado.sigla")?.setValue(t?.sigla)}getEstados(){this.estadoService.findAll().pipe((0,c.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.estados=t,this.estados.length>0&&(this.estadoSelecionado=this.estados[0],this.setEstadoNosFormularios(this.estadoSelecionado)))},error:t=>{console.log(t)}})}onEstadoChange(t){this.estadoService.findById(t).pipe((0,c.R)(this.destroy$)).subscribe({next:i=>{i&&(this.estadoSelecionado=i)},error(i){console.log(i)}})}handleSubmitAddCidade(){const t=[];if(Object.keys(this.addCidadeForm.controls).forEach(i=>{const d=this.addCidadeForm.get(i);d&&d.invalid&&t.push(i)}),t.length>0){const i=`Os campos ${t.join(", ")} est\xe3o inv\xe1lidos.`;return this.markFormGroupTouched(this.addCidadeForm),void this.messageService.add({severity:"warn",summary:"Aviso",detail:i,life:3e3})}this.cidadeService.create(this.addCidadeForm.value).pipe((0,c.R)(this.destroy$)).subscribe({next:i=>{i&&(this.messageService.add({severity:"success",summary:"Sucesso",detail:`A cidade ${i.nome} foi criada com sucesso!`,life:2e3}),this.addCidadeForm.reset())},error:i=>{this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao criar Conta.",life:2e3}),console.log(i)}})}handleSubmitEditCidade(){const t=[];if(Object.keys(this.editCidadeForm.controls).forEach(d=>{const s=this.editCidadeForm.get(d);s&&s.invalid&&t.push(d)}),t.length>0){const d=`Os campos ${t.join(", ")} est\xe3o inv\xe1lidos.`;return this.markFormGroupTouched(this.editCidadeForm),void this.messageService.add({severity:"warn",summary:"Aviso",detail:d,life:3e3})}this.cidadeService.update({cidId:this.cidadeAction.event.id,nome:this.editCidadeForm.value.nome,estado:{id:this.estadoSelecionado.id,nome:this.estadoSelecionado.nome,sigla:this.estadoSelecionado.sigla}}).pipe((0,c.R)(this.destroy$)).subscribe({next:d=>{d&&(this.editCidadeForm.reset(),this.messageService.add({severity:"success",summary:"Sucesso",detail:"A cidade foi editada com sucesso!",life:2e3}))},error:d=>{console.log(d),this.editCidadeForm.reset(),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao editar cidade",life:2e3})}})}markFormGroupTouched(t){Object.values(t.controls).forEach(i=>{i instanceof n.cw?this.markFormGroupTouched(i):i.markAsTouched()})}getCidadeSelectedDatas(t){if(this.cidadeAction&&this.cidadeAction.cidadeList){const i=this.cidadeAction.cidadeList;if(i.length>0){const d=i.find(s=>s?.cidId===t);d&&(this.cidadesSelectedDatas=d,this.estadoSelecionado=d.estado,this.editCidadeForm.patchValue({nome:d.nome,estado:{id:d?.estado?.id}}))}}}getUserDatas(){this.cidadeService.findAll().pipe((0,c.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.cidadeDatas=t,this.cidadeDatas&&this.cidadeDTO.setCidadesDatas(this.cidadeDatas))}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(n.qu),e.Y36(u.ez),e.Y36(g.F0),e.Y36(b.F),e.Y36(F.s),e.Y36(m.S),e.Y36(y),e.Y36(p.uU))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-cidade-form"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"card","flex","flex-column","md:flex-column","gap-3"],["pInputText","","placeholder","Nome","formControlName","nome"],["formGroupName","estado"],["styleClass","w-full","placeholder","Selecione o estado","formControlName","id","optionLabel","nome","optionValue","id",3,"options","onChange"],[1,"flex","flex-row","justify-content-center","align-items-center","align-content-center","m-1"],["type","submit",1,"p-button"]],template:function(i,d){1&i&&(e.YNc(0,w,9,2,"div",0),e.YNc(1,N,9,2,"div",0)),2&i&&(e.Q6J("ngIf",d.cidadeAction.event.action===d.addCidadeAction),e.xp6(1),e.Q6J("ngIf",d.cidadeAction.event.action===d.editCidadeAction))},dependencies:[p.O5,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,n.x0,x.o,A.Lt]})}return a})();function M(a,C){if(1&a&&(e.TgZ(0,"div",1)(1,"div",2)(2,"strong"),e._uU(3,"ID:"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"div",2)(6,"strong"),e._uU(7,"Nome:"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"div",2)(10,"strong"),e._uU(11,"Estado:"),e.qZA(),e._uU(12),e.qZA()()),2&a){const t=e.oxw();e.xp6(4),e.hij(" ",t.cidade.cidId," "),e.xp6(4),e.hij(" ",t.cidade.nome," "),e.xp6(4),e.AsE(" ",null==t.cidade.estado?null:t.cidade.estado.nome," ",null==t.cidade.estado?null:t.cidade.estado.sigla," ")}}let V=(()=>{class a{constructor(t,i){this.ref=t,this.config=i}ngOnInit(){this.cidade=this.config.data.cidade}close(){this.ref.close()}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(m.E7),e.Y36(m.S))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-cidade-view"]],decls:1,vars:1,consts:[["class","p-grid p-dir-col",4,"ngIf"],[1,"p-grid","p-dir-col"],[1,"p-col"]],template:function(i,d){1&i&&e.YNc(0,M,13,4,"div",0),2&i&&e.Q6J("ngIf",d.cidade)},dependencies:[p.O5]})}return a})();var J=o(5226),$=o(3066),S=o(3904),_=o(4532),f=o(707),h=o(909),Z=o(3259);function U(a,C){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"th",7)(2,"div",8)(3,"div",8),e._uU(4," ID "),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"p-sortIcon",9)(7,"p-columnFilter",10),e.qZA()()(),e.TgZ(8,"th",11)(9,"div",8)(10,"div",8),e._uU(11," Nome "),e.qZA(),e.TgZ(12,"div",8),e._UZ(13,"p-sortIcon",12)(14,"p-columnFilter",13),e.qZA()()(),e.TgZ(15,"th",14)(16,"div",8)(17,"div",8),e._uU(18," Estado "),e.qZA(),e.TgZ(19,"div",8),e._UZ(20,"p-sortIcon",15)(21,"p-columnFilter",16),e.qZA()()(),e.TgZ(22,"th")(23,"div",17)(24,"p-button",18),e.NdJ("onClick",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.handleCidadeEvent(d.createCidadeEvent))}),e.qZA()()()()}2&a&&(e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function O(a,C){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"div",19)(9,"button",20),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.handleCidadeEvent(r.editCidadeEvent,null==s?null:s.cidId))}),e.qZA(),e.TgZ(10,"button",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.handleDeleteCidade(null==s?null:s.cidId,null==s?null:s.nome))}),e.qZA(),e.TgZ(11,"button",22),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.handleCidadeEvent(r.viewCidadeEvent,null==s?null:s.cidId))}),e.qZA()()()()}if(2&a){const t=C.$implicit;e.xp6(2),e.Oqu(null==t?null:t.cidId),e.xp6(2),e.Oqu(null==t?null:t.nome),e.xp6(2),e.Oqu(null==t?null:t.estado.nome)}}const R=function(){return["nome","login","nivelAcesso"]},j=function(){return{"min-width":"75rem"}};let B=(()=>{class a{constructor(){this.cidades=[],this.cidadeEvent=new e.vpe,this.deleteCidadeEvent=new e.vpe,this.createCidadeEvent=l.CREATE_CITY_EVENT,this.editCidadeEvent=l.EDIT_CITY_EVENT,this.viewCidadeEvent=l.VIEW_CITY_EVENT}handleCidadeEvent(t,i){void 0!==t&&""!==t&&this.cidadeEvent.emit(i&&null!==i?{action:t,id:i}:{action:t})}handleDeleteCidade(t,i){console.log("Chamou"),t&&null!==t&&this.deleteCidadeEvent.emit({cid_id:t,nome:i})}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-cidade-table"]],inputs:{cidades:"cidades"},outputs:{cidadeEvent:"cidadeEvent",deleteCidadeEvent:"deleteCidadeEvent"},decls:7,vars:11,consts:[[1,"grid"],[1,"col-12"],["styleClass","shadow-3 mt-5 text-indigo-400","header","Cidades"],["dataKey","id","currentPageReportTemplate","Mostrando {first} de {last} de {totalRecords} cidades",3,"value","rows","paginator","responsive","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["usersTable",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-itens-center"],["field","id"],["type","text","field","id","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","nome"],["field","nome"],["type","text","field","nome","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","estado"],["field","estado"],["type","text","field","estado","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],[1,"flex","justify-content-center"],["styleClass","p-button-info","icon","pi pi-plus","label","Novo","pTooltip","Cadastrar nova cidade","tooltipPosition","top",3,"onClick"],[1,"flex","justify-content-center","gap-3","align-itens-center","align-content-center"],["pButton","","pRipple","","icon","pi pi-pencil","pTooltip","Editar Ciadade","tooltipPosition","top",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Excluir Ciadade","tooltipPosition","top",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","pRipple","","icon","pi pi-eye","pTooltip","Visualizar Cidade","tooltipPosition","top",1,"p-button-rounded","p-button-sucess",3,"click"]],template:function(i,d){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(r){return d.citySelected=r}),e.YNc(5,U,25,9,"ng-template",5),e.YNc(6,O,12,3,"ng-template",6),e.qZA()()()()),2&i&&(e.xp6(3),e.Q6J("value",d.cidades)("rows",10)("paginator",!0)("responsive",!0)("globalFilterFields",e.DdM(9,R))("tableStyle",e.DdM(10,j))("selection",d.citySelected)("rowHover",!0)("showCurrentPageReport",!0))},dependencies:[_.Z,u.jx,f.Hq,f.zx,h.iA,h.lQ,h.fz,h.xl,Z.u]})}return a})();const H=function(){return{width:"50vw"}},z=[{path:"",component:(()=>{class a{constructor(t,i,d,s,r,v){this.cidadeService=t,this.cidadeDtransferService=i,this.router=d,this.messageService=s,this.confirmationService=r,this.dialogService=v,this.destroy$=new E.x,this.cidadeList=[],this.sidebarVisible=!1}ngOnInit(){this.getServiceCiadadesDatas()}getServiceCiadadesDatas(){const t=this.cidadeDtransferService.getCidadesDatas();t.length>0?this.cidadeList=t:this.getAPICidadesDatas()}getAPICidadesDatas(){this.cidadeService.findAll().pipe((0,c.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.cidadeList=t)},error:t=>{console.log(t),this.router.navigate(["home"]),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar ciades",life:2500})}})}handleCidadeAction(t){t.action===l.CREATE_CITY_EVENT||t.action===l.EDIT_CITY_EVENT?(this.ref=this.dialogService.open(Y,{header:t?.action,width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:{event:t,cidadeList:this.cidadeList}}),this.ref.onClose.pipe((0,c.R)(this.destroy$)).subscribe({next:()=>this.getAPICidadesDatas()})):this.handleViewCidadeAction(t)}handleOpenSidebar(){this.sidebarVisible=!this.sidebarVisible}handleDeleteCidadeAction(t){t&&this.confirmationService.confirm({message:`Deseja realmente deletar a ciade ${t?.nome}?`,header:"Confirma\xe7\xe3o de exclus\xe3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"N\xe3o",accept:()=>this.deleteCidade(t?.cid_id)})}handleViewCidadeAction(t){t&&this.cidadeService.findById(t?.id).pipe((0,c.R)(this.destroy$)).subscribe({next:i=>{i&&(this.ref=this.dialogService.open(V,{header:t?.action,width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:{cidade:i}}),this.ref.onClose.pipe((0,c.R)(this.destroy$)).subscribe({next:()=>this.getAPICidadesDatas()}))},error(i){console.log(i)}})}deleteCidade(t){t&&this.cidadeService.delete(t).pipe((0,c.R)(this.destroy$)).subscribe({next:i=>{this.getAPICidadesDatas(),this.messageService.add({severity:"success",summary:"Sucesso",detail:"Cidade Excluida com sucesso!",life:2500})},error:i=>{console.log(i),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao excluir cidade",life:2500})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(b.F),e.Y36(y),e.Y36(g.F0),e.Y36(u.ez),e.Y36(u.YP),e.Y36(m.xA))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-cidade-home"]],decls:4,vars:5,consts:[[3,"openSidebarEvent"],[3,"sidebarVisible"],[3,"cidades","cidadeEvent","deleteCidadeEvent"]],template:function(i,d){1&i&&(e.TgZ(0,"app-toolbar",0),e.NdJ("openSidebarEvent",function(){return d.handleOpenSidebar()}),e.qZA(),e._UZ(1,"app-side-bar",1),e.TgZ(2,"app-cidade-table",2),e.NdJ("cidadeEvent",function(r){return d.handleCidadeAction(r)})("deleteCidadeEvent",function(r){return d.handleDeleteCidadeAction(r)}),e.qZA(),e._UZ(3,"p-confirmDialog")),2&i&&(e.xp6(1),e.Q6J("sidebarVisible",d.sidebarVisible),e.xp6(1),e.Q6J("cidades",d.cidadeList),e.xp6(1),e.Akn(e.DdM(4,H)))},dependencies:[J.n,$.P,S.Q,B]})}return a})()}];var L=o(6208),P=o(9862),G=o(9663),Q=o(5609),q=o(6218),k=o(9653);let K=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#i=this.\u0275inj=e.cJS({providers:[m.xA,u.YP,p.uU],imports:[p.ez,n.u5,n.UX,g.Bz.forChild(z),L.m,P.JF,_.d,f.hJ,h.U$,G.zz,Q.Iu,x.j,q.A,k.L$,m.DL,A.kW,S.D,Z.z]})}return a})()}}]);