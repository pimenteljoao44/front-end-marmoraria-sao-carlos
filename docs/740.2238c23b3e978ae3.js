"use strict";(self.webpackChunkmarmoraria_sao_carlos=self.webpackChunkmarmoraria_sao_carlos||[]).push([[740],{4740:(j,U,r)=>{r.r(U),r.d(U,{UsersModule:()=>V});var A=r(6814),l=r(6223),_=r(6208),F=r(9862),T=r(4532),m=r(707),u=r(909),M=r(9663),w=r(5609),x=r(3714),D=r(6218),I=r(9653),h=r(5118),S=r(3866),b=r(3904),E=r(3259),c=r(5219),g=r(1365),C=r(8645),d=r(9773),p=function(i){return i.CREATE_USER_EVENT="Criar usuario",i.EDIT_USER_EVENT="Editar usuario",i}(p||{}),e=r(4946),Z=r(6530),y=r(3574);function J(i,v){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleSubmitAddUser())}),e.TgZ(2,"div",2),e._UZ(3,"input",3)(4,"input",4)(5,"input",5)(6,"input",6),e.TgZ(7,"p-dropdown",7),e.NdJ("ngModelChange",function(o){e.CHM(t);const n=e.oxw();return e.KtG(n.nivelSelected=o)}),e.qZA(),e.TgZ(8,"div",8),e._UZ(9,"p-button",9),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.addUserForm),e.xp6(6),e.Q6J("options",t.niveisAcesso)("ngModel",t.nivelSelected),e.xp6(2),e.Q6J("disabled",!t.addUserForm.valid)}}function N(i,v){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleSubmitEditUser())}),e.TgZ(2,"div",2),e._UZ(3,"input",3)(4,"input",4)(5,"input",5)(6,"input",6),e.TgZ(7,"p-dropdown",7),e.NdJ("ngModelChange",function(o){e.CHM(t);const n=e.oxw();return e.KtG(n.nivelSelected=o)}),e.qZA(),e.TgZ(8,"div",8),e._UZ(9,"p-button",9),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.editUserForm),e.xp6(6),e.Q6J("options",t.niveisAcesso)("ngModel",t.nivelSelected),e.xp6(2),e.Q6J("disabled",!t.editUserForm.valid)}}let O=(()=>{class i{constructor(t,s,o,n,a,f){this.formBuilder=t,this.messageService=s,this.router=o,this.userService=n,this.ref=a,this.userDTO=f,this.destroy$=new C.x,this.niveisAcesso=[{label:"Gerente",value:0},{label:"Funcion\xe1rio",value:1}],this.nivelSelected=[],this.userDatas=[],this.addUserForm=this.formBuilder.group({nome:["",l.kI.required],login:["",l.kI.required],senha:["",l.kI.required],email:["",l.kI.required],nivelAcesso:[null,l.kI.required]}),this.editUserForm=this.formBuilder.group({nome:["",l.kI.required],login:["",l.kI.required],senha:["",l.kI.required],email:["",l.kI.required],nivelAcesso:[null,l.kI.required]}),this.addUserAction=p.CREATE_USER_EVENT,this.editUserAction=p.EDIT_USER_EVENT}ngOnInit(){this.userAction=this.ref.data,this.userAction?.event.action===this.editUserAction&&this.userAction?.userList&&this.getUserSelectedDatas(this.userAction?.event?.id)}handleSubmitAddUser(){this.addUserForm.value&&this.addUserForm.valid&&this.userService.create(this.addUserForm.value).pipe((0,d.R)(this.destroy$)).subscribe({next:t=>{t&&(this.addUserForm.reset(),this.messageService.add({severity:"success",summary:"Sucesso",detail:`O usu\xe1rio ${t.nome} foi criado com sucesso!`,life:2e3}))},error:t=>{this.messageService.add({severity:"error",summary:"Erro",detail:`Erro ao criar Conta ${t.error.error}`,life:2e3}),console.log(t)}})}handleSubmitEditUser(){this.editUserForm?.value&&this.editUserForm?.valid&&this.userAction.event.id&&this.userService.update({id:this.userAction?.event?.id,nome:this.editUserForm?.value?.nome,login:this.editUserForm?.value?.login,senha:this.editUserForm?.value?.senha,email:this.editUserForm?.value?.email,nivelAcesso:this.editUserForm?.value.nivelAcesso,token:""}).pipe((0,d.R)(this.destroy$)).subscribe({next:s=>{s&&(this.editUserForm.reset(),this.messageService.add({severity:"success",summary:"Sucesso",detail:"O usu\xe1rio editado com sucesso!",life:2e3}))},error:s=>{console.log(s),this.addUserForm.reset(),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao editar usuario",life:2e3})}})}getUserSelectedDatas(t){const s=this.userAction.userList;if(s.length>0){const o=s.filter(n=>n?.id===t);o&&(this.usersSelectedDatas=o[0],this.editUserForm.setValue({nome:this.usersSelectedDatas?.nome,login:this.usersSelectedDatas?.login,senha:"",email:this.usersSelectedDatas?.email,nivelAcesso:this.usersSelectedDatas?.nivelAcesso}))}}getUserDatas(){this.userService.findAll().pipe((0,d.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.userDatas=t,this.userDatas&&this.userDTO.setUsersDatas(this.userDatas))}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(l.qu),e.Y36(c.ez),e.Y36(g.F0),e.Y36(Z.K),e.Y36(h.S),e.Y36(y.q))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-form"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"card","flex","flex-column","md:flex-column","gap-3"],["pInputText","","placeholder","Nome.","formControlName","nome"],["pInputText","","placeholder","Login.","formControlName","login"],["pInputText","","placeholder","Senha.","formControlName","senha"],["pInputText","","placeholder","Email","formControlName","email"],["styleClass","w-full","placeholder","Selecione o n\xedvel de acesso","formControlName","nivelAcesso","optionLabel","label","optionValue","value","placeholder","Selecione um n\xedvel de acesso",3,"options","ngModel","ngModelChange"],[1,"flex","flex-row","justify-content-center","align-items-center","align-content-center","m-1"],["type","submit","label","Concluir",3,"disabled"]],template:function(s,o){1&s&&(e.YNc(0,J,10,4,"div",0),e.YNc(1,N,10,4,"div",0)),2&s&&(e.Q6J("ngIf",o.userAction.event.action===o.addUserAction),e.xp6(1),e.Q6J("ngIf",o.userAction.event.action===o.editUserAction))},dependencies:[A.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,m.zx,x.o,S.Lt]})}return i})();var R=r(5226),$=r(3066);function q(i,v){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"th",7)(2,"div",8)(3,"div",8),e._uU(4," ID "),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"p-sortIcon",9)(7,"p-columnFilter",10),e.qZA()()(),e.TgZ(8,"th",11)(9,"div",8)(10,"div",8),e._uU(11," Nome "),e.qZA(),e.TgZ(12,"div",8),e._UZ(13,"p-sortIcon",12)(14,"p-columnFilter",13),e.qZA()()(),e.TgZ(15,"th",14)(16,"div",8)(17,"div",8),e._uU(18," Login "),e.qZA(),e.TgZ(19,"div",8),e._UZ(20,"p-sortIcon",15)(21,"p-columnFilter",16),e.qZA()()(),e.TgZ(22,"th",17)(23,"div",8)(24,"div",8),e._uU(25," Email "),e.qZA(),e.TgZ(26,"div",8),e._UZ(27,"p-sortIcon",18)(28,"p-columnFilter",19),e.qZA()()(),e.TgZ(29,"th",20)(30,"div",8)(31,"div",8),e._uU(32," Nivel de Acesso "),e.qZA(),e.TgZ(33,"div",8),e._UZ(34,"p-sortIcon",21)(35,"p-columnFilter",22),e.qZA()()(),e.TgZ(36,"th")(37,"div",23)(38,"p-button",24),e.NdJ("onClick",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleUserEvent(o.createUserEvent))}),e.qZA()()()()}2&i&&(e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function Y(i,v){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"div",25)(13,"button",26),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.handleUserEvent(a.editUserEvent,null==n?null:n.id))}),e.qZA(),e.TgZ(14,"button",27),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.handleDeleteUser(null==n?null:n.id,null==n?null:n.nome))}),e.qZA()()()()}if(2&i){const t=v.$implicit;e.xp6(2),e.Oqu(null==t?null:t.id),e.xp6(2),e.Oqu(null==t?null:t.nome),e.xp6(2),e.Oqu(null==t?null:t.login),e.xp6(2),e.Oqu(null==t?null:t.email),e.xp6(2),e.Oqu(null==t?null:t.nivelAcesso)}}const L=function(){return["nome","login","nivelAcesso"]},Q=function(){return{"min-width":"75rem"}};let B=(()=>{class i{constructor(){this.usuarios=[],this.userEvent=new e.vpe,this.deleteUserEvent=new e.vpe,this.createUserEvent=p.CREATE_USER_EVENT,this.editUserEvent=p.EDIT_USER_EVENT}handleUserEvent(t,s){void 0!==t&&""!==t&&this.userEvent.emit(s&&null!==s?{action:t,id:s}:{action:t})}handleDeleteUser(t,s){t&&null!==t&&this.deleteUserEvent.emit({user_id:t,nome:s})}static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-users-table"]],inputs:{usuarios:"usuarios"},outputs:{userEvent:"userEvent",deleteUserEvent:"deleteUserEvent"},decls:7,vars:11,consts:[[1,"grid"],[1,"col-12"],["styleClass","shadow-3 mt-5 text-indigo-400","header","Usuarios"],["dataKey","id","currentPageReportTemplate","Mostrando {first} de {last} de {totalRecords} usu\xe1rios",3,"value","rows","paginator","responsive","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["usersTable",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-itens-center"],["field","id"],["type","text","field","id","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","nome"],["field","nome"],["type","text","field","nome","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","login"],["field","login"],["type","text","field","login","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","email"],["field","email"],["type","text","field","email","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","nivelAcesso"],["field","nivelAcesso"],["type","text","field","nivelAcesso","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],[1,"flex","justify-content-center"],["styleClass","p-button-info","icon","pi pi-plus","label","Novo","pTooltip","Cadastrar novo usuario","tooltipPosition","top",3,"onClick"],[1,"flex","justify-content-center","gap-3","align-itens-center","align-content-center"],["pButton","","pRipple","","icon","pi pi-pencil","pTooltip","Editar Usuario","tooltipPosition","top",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Excluir Usuario","tooltipPosition","top",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(s,o){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(a){return o.userSelected=a}),e.YNc(5,q,39,15,"ng-template",5),e.YNc(6,Y,15,5,"ng-template",6),e.qZA()()()()),2&s&&(e.xp6(3),e.Q6J("value",o.usuarios)("rows",10)("paginator",!0)("responsive",!0)("globalFilterFields",e.DdM(9,L))("tableStyle",e.DdM(10,Q))("selection",o.userSelected)("rowHover",!0)("showCurrentPageReport",!0))},dependencies:[T.Z,c.jx,m.Hq,m.zx,u.iA,u.lQ,u.fz,u.xl,E.u]})}return i})();const H=function(){return{widith:"50vw"}},P=[{path:"",component:(()=>{class i{constructor(t,s,o,n,a,f){this.usersService=t,this.usersDtransferService=s,this.router=o,this.messageService=n,this.confirmationService=a,this.dialogService=f,this.destroy$=new C.x,this.userList=[],this.sidebarVisible=!1}ngOnInit(){this.getServiceUsersDatas()}getServiceUsersDatas(){const t=this.usersDtransferService.getUsersDatas();t.length>0?this.userList=t:this.getAPIUsersDatas()}getAPIUsersDatas(){this.usersService.findAll().pipe((0,d.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.userList=t)},error:t=>{console.log(t),this.router.navigate(["home"]),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar usuarios",life:2500})}})}handleUserAction(t){t&&(this.ref=this.dialogService.open(O,{header:t?.action,width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:{event:t,userList:this.userList}}),this.ref.onClose.pipe((0,d.R)(this.destroy$)).subscribe({next:()=>this.getAPIUsersDatas()}))}handleOpenSidebar(){this.sidebarVisible=!this.sidebarVisible}handleDeleteUserAction(t){t&&this.confirmationService.confirm({message:`Deseja realmente deletar o usu\xe1rio ${t?.nome}?`,header:"Confirma\xe7\xe3o de exclus\xe3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"N\xe3o",accept:()=>this.deleteUser(t?.user_id)})}deleteUser(t){t&&this.usersService.delete(t).pipe((0,d.R)(this.destroy$)).subscribe({next:s=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Usuario Excluido com sucesso!",life:2500}),this.getAPIUsersDatas()},error:s=>{console.log(s),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao excluir produto",life:2500})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(Z.K),e.Y36(y.q),e.Y36(g.F0),e.Y36(c.ez),e.Y36(c.YP),e.Y36(h.xA))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-users-home"]],decls:4,vars:5,consts:[[3,"openSidebarEvent"],[3,"sidebarVisible"],[3,"usuarios","userEvent","deleteUserEvent"]],template:function(s,o){1&s&&(e.TgZ(0,"app-toolbar",0),e.NdJ("openSidebarEvent",function(){return o.handleOpenSidebar()}),e.qZA(),e._UZ(1,"app-side-bar",1),e.TgZ(2,"app-users-table",2),e.NdJ("userEvent",function(a){return o.handleUserAction(a)})("deleteUserEvent",function(a){return o.handleDeleteUserAction(a)}),e.qZA(),e._UZ(3,"p-confirmDialog")),2&s&&(e.xp6(1),e.Q6J("sidebarVisible",o.sidebarVisible),e.xp6(1),e.Q6J("usuarios",o.userList),e.xp6(1),e.Akn(e.DdM(4,H)))},dependencies:[R.n,$.P,b.Q,B]})}return i})()}];let V=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#s=this.\u0275inj=e.cJS({providers:[h.xA,c.YP],imports:[A.ez,l.u5,l.UX,g.Bz.forChild(P),_.m,F.JF,T.d,m.hJ,u.U$,M.zz,w.Iu,x.j,D.A,I.L$,h.DL,S.kW,b.D,E.z]})}return i})()}}]);